<!DOCTYPE html>
<html lang="ko-kr">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>
      difference-between-two | gglee Blog
      
    </title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">

  </head>

  <body>
    <header>
      <div class="site-max-width">
        <nav class="header">
          <div class="header-container">
          <div class="banner">
<a href="/" class="text">
&gfr;&gfr;&lfr;&efr;&efr; &Bfr;&lfr;&ofr;&gfr;

</a>
</div>

          <div class="header-meta">
            

            
            <span class="header-meta-item1"><a href="/">&larr; Home</a></span>
              
              <span class="header-meta-item2 date">2020-04-19</span>
              
              
                
                
                  
                
                
                
            <span class="header-meta-item3">
              
            </span>
              
            
          
          </div>
        </nav>
      </div>
    </div>
  </header>


<div class="site-max-width">
  <article class="article-container">
    <div class="article-meta">
      <span class="article-category">
        
        <a href="/categories/statistics">statistics</a>
        
      </span>
      <h1>difference-between-two</h1>

      
      <h3>gglee
</h3>
      

      
      <span>Tags: <a href="/tags/basic">basic</a>
      </span>
      

      
    </div>

    

    


<p>두 표본의 통계량 차이를 반복실험을 통해서 알아보자. 일반적으로 잘알려진 사실은 두 표본의 평균의 차는 변하지 않는다. 다만, 편차, 신뢰구간, 또는 표준오차는 몇개를 뽑느냐, 모분산이 있느냐 없느냐에 따라 여러 계산식으로 표현될 수 있다. 하지만, 간단하게 반복실험을 해보면 쉽게 결과를 확인할 수 있다.</p>
<p>정규분포를 가지는 두 집단에서의 차이를 계산하는 함수이다.</p>
<pre class="r"><code>simulation_diff &lt;- function(n1, m1, s1, n2, m2, s2, n_total = 100000) {
  m &lt;-list()
  for (i in 1:n_total) {
    x1 &lt;- rnorm(n1, m1, s1)
    x2 &lt;- rnorm(n2, m2, s2)
    x1_m &lt;- mean(x1)
    x2_m &lt;- mean(x2)
    m[[i]] &lt;- x2_m - x1_m
  }
  unlist(m)
}</code></pre>
<div id="한번만-측정시" class="section level2">
<h2>한번만 측정시</h2>
<pre class="r"><code>sim1 &lt;- simulation_diff(n1 = 1, m1 = 10, s1 = 1, n2 = 1, m2 = 11, s2 = 1)
mean(sim1)  # = 11 - 10 </code></pre>
<pre><code>## [1] 0.9963212</code></pre>
<pre class="r"><code>var(sim1)   # = 1^2 + 1^2</code></pre>
<pre><code>## [1] 1.999038</code></pre>
<pre class="r"><code>sd(sim1)    # sqrt(var(sim1)</code></pre>
<pre><code>## [1] 1.413873</code></pre>
</div>
<div id="각각-2번씩-측정할-경우" class="section level2">
<h2>각각 2번씩 측정할 경우</h2>
<pre class="r"><code>sim2 &lt;- simulation_diff(n1 = 2, m1 = 10, s1 = 1, n2 = 2, m2 = 11, s2 = 1)
mean(sim2)  # = 11 - 10 </code></pre>
<pre><code>## [1] 0.9974379</code></pre>
<pre class="r"><code>var(sim2)   # = 1^2 / 2 + 1^2 / 2</code></pre>
<pre><code>## [1] 1.003207</code></pre>
</div>
<div id="두-표본의-sd가-다른-경우" class="section level2">
<h2>두 표본의 sd가 다른 경우</h2>
<pre class="r"><code>sim3 &lt;- simulation_diff(n1 = 2, m1 = 10, s1 = 2, n2 = 2, m2 = 11, s2 = 1)
mean(sim3)  # = 11 - 10 </code></pre>
<pre><code>## [1] 0.9983419</code></pre>
<pre class="r"><code>var(sim3)   # = 2^2 / 2 + 1^2 / 2</code></pre>
<pre><code>## [1] 2.483735</code></pre>
<p>보다시피 어떤 경우에도 잘 대응된다. 즉 일반적으로,</p>
<p><span class="math display">\[ var(x_2 - x_1) = \frac{var(x_1)}{N_1} + \frac{var(x_2)}{N_2}  \]</span>
<span class="math display">\[ sd(x_2 - x_1) = \sqrt{ \frac{sd(x_1)^2}{N_1} + \frac{sd(x_2)^2}{N_2}  } \]</span></p>
</div>
<div id="실전-적용" class="section level2">
<h2>실전 적용</h2>
<p>철판 두께 측정으로 다시 생각해보자.</p>
<pre class="r"><code>rnorm_simulation &lt;- function(inspection, 
                             mu, 
                             sigma, 
                             n_sample, 
                             n_test = 10000, 
                             seed = NULL) {
  if (!is.null(seed)) set.seed(seed)
  m_list &lt;- vector(&quot;double&quot;, n_test)
  s_list &lt;- vector(&quot;double&quot;, n_test)
  v_list &lt;- vector(&quot;double&quot;, n_test)
  for (i in 1:n_test) {
    a_sample &lt;- rnorm(n_sample, mean = mu, sd = sigma)
    m_list[[i]] &lt;- mean(a_sample)
    s_list[[i]] &lt;- sd(a_sample)
    v_list[[i]] &lt;- var(a_sample)
  }
  tibble(
    inspection = inspection,
    grid = 1:n_test,
    n_sample = n_sample, 
    sample_mean = m_list, 
    sample_sd = s_list, 
    sample_var = v_list)  
}</code></pre>
<pre class="r"><code>df1 &lt;- rnorm_simulation(
  inspection = &quot;1st&quot;, mu = 10, sigma = 1, n_sample = 4, seed = 21
) %&gt;% rename_all(~str_c(., &#39;_1&#39;))
df1</code></pre>
<pre><code>## # A tibble: 10,000 x 6
##    inspection_1 grid_1 n_sample_1 sample_mean_1 sample_sd_1 sample_var_1
##    &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
##  1 1st               1          4         10.4        1.26         1.59 
##  2 1st               2          4         10.0        1.67         2.78 
##  3 1st               3          4          9.64       1.32         1.74 
##  4 1st               4          4         10.4        0.859        0.737
##  5 1st               5          4         10.1        0.896        0.803
##  6 1st               6          4          9.53       0.806        0.650
##  7 1st               7          4          9.93       0.809        0.654
##  8 1st               8          4          9.08       0.627        0.394
##  9 1st               9          4         10.7        0.769        0.591
## 10 1st              10          4         11.2        0.772        0.596
## # … with 9,990 more rows</code></pre>
<pre class="r"><code>df2 &lt;- rnorm_simulation(
  inspection = &quot;2nd&quot;, mu = 9, sigma = 1, n_sample = 4, seed = 23
) %&gt;% rename_all(~str_c(., &#39;_2&#39;))
df2</code></pre>
<pre><code>## # A tibble: 10,000 x 6
##    inspection_2 grid_2 n_sample_2 sample_mean_2 sample_sd_2 sample_var_2
##    &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
##  1 2nd               1          4          9.62       0.959        0.919
##  2 2nd               2          4          9.71       0.661        0.437
##  3 2nd               3          4          9.20       1.08         1.16 
##  4 2nd               4          4          8.82       0.766        0.587
##  5 2nd               5          4          8.93       0.910        0.828
##  6 2nd               6          4          8.97       0.999        0.999
##  7 2nd               7          4          9.05       0.833        0.693
##  8 2nd               8          4          8.76       0.430        0.185
##  9 2nd               9          4          8.39       0.703        0.495
## 10 2nd              10          4          9.26       1.16         1.34 
## # … with 9,990 more rows</code></pre>
<pre class="r"><code>dd &lt;- 
  bind_cols(df1, df2)
dd</code></pre>
<pre><code>## # A tibble: 10,000 x 12
##    inspection_1 grid_1 n_sample_1 sample_mean_1 sample_sd_1 sample_var_1
##    &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
##  1 1st               1          4         10.4        1.26         1.59 
##  2 1st               2          4         10.0        1.67         2.78 
##  3 1st               3          4          9.64       1.32         1.74 
##  4 1st               4          4         10.4        0.859        0.737
##  5 1st               5          4         10.1        0.896        0.803
##  6 1st               6          4          9.53       0.806        0.650
##  7 1st               7          4          9.93       0.809        0.654
##  8 1st               8          4          9.08       0.627        0.394
##  9 1st               9          4         10.7        0.769        0.591
## 10 1st              10          4         11.2        0.772        0.596
## # … with 9,990 more rows, and 6 more variables: inspection_2 &lt;chr&gt;,
## #   grid_2 &lt;int&gt;, n_sample_2 &lt;dbl&gt;, sample_mean_2 &lt;dbl&gt;, sample_sd_2 &lt;dbl&gt;,
## #   sample_var_2 &lt;dbl&gt;</code></pre>
<pre class="r"><code>dd &lt;- dd %&gt;% 
  mutate(
    diff_mean = sample_mean_2 - sample_mean_1,
    diff_sd = sqrt(sample_sd_2^2 / n_sample_2 + sample_sd_1^2 / n_sample_1),
    diff_var = sample_var_2 / n_sample_2 + sample_var_1 / n_sample_1
  )
dd</code></pre>
<pre><code>## # A tibble: 10,000 x 15
##    inspection_1 grid_1 n_sample_1 sample_mean_1 sample_sd_1 sample_var_1
##    &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
##  1 1st               1          4         10.4        1.26         1.59 
##  2 1st               2          4         10.0        1.67         2.78 
##  3 1st               3          4          9.64       1.32         1.74 
##  4 1st               4          4         10.4        0.859        0.737
##  5 1st               5          4         10.1        0.896        0.803
##  6 1st               6          4          9.53       0.806        0.650
##  7 1st               7          4          9.93       0.809        0.654
##  8 1st               8          4          9.08       0.627        0.394
##  9 1st               9          4         10.7        0.769        0.591
## 10 1st              10          4         11.2        0.772        0.596
## # … with 9,990 more rows, and 9 more variables: inspection_2 &lt;chr&gt;,
## #   grid_2 &lt;int&gt;, n_sample_2 &lt;dbl&gt;, sample_mean_2 &lt;dbl&gt;, sample_sd_2 &lt;dbl&gt;,
## #   sample_var_2 &lt;dbl&gt;, diff_mean &lt;dbl&gt;, diff_sd &lt;dbl&gt;, diff_var &lt;dbl&gt;</code></pre>
<pre class="r"><code>dd %&gt;% summarize(
  average_diff_mean = mean(diff_mean),
  average_diff_sd = mean(diff_sd),  # caution: not sqrt(diff_var)
  average_diff_var = mean(diff_var)
)</code></pre>
<pre><code>## # A tibble: 1 x 3
##   average_diff_mean average_diff_sd average_diff_var
##               &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;
## 1             -1.01           0.680            0.503</code></pre>
<pre class="r"><code>dd %&gt;% 
  pivot_longer(
    cols = c(&quot;diff_mean&quot;, &quot;diff_var&quot;), 
    names_to = &quot;keys&quot;, values_to = &quot;values&quot;
  ) %&gt;%
  ggplot(aes(values)) +
  geom_histogram(color = &quot;black&quot;, fill = &quot;white&quot;) +
    facet_wrap(~keys, scales = &quot;free&quot;)</code></pre>
<p><img src="/post/2020-04-19-difference-between-two_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>

    
    













<div class="post-footer">
  <span style="font-weight: bold;">Author says:</span><br />
  
  <span>미니멀 블로그에 오신 것을 환영합니다. 레트로 느낌을 좋아하신다면 만족하실 것입니다!</span>
  
</div>




    
    
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "gglee-blog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    
<nav class="post-nav">
  <span style="text-align: left;"><a href="/post/2020/test2/">&larr; test2</a></span>
  <span style="text-align: right;"><a href="/post/2020/thickness-measurement-statistic/">두께측정으로 알아보는 통계량 &rarr;</a></span>
</nav>


  </article>
</div>

<footer>
  
  <div class="site-max-width">
    <div class="footer-container">
      <ul class="site-menu">
        
        <li><a href="/"><span data-hover="Home">Home</span></a></li>
        
        <li><a href="/about/"><span data-hover="About">About</span></a></li>
        
        <li><a href="/categories/"><span data-hover="Categories">Categories</span></a></li>
        
        <li><a href="/tags/"><span data-hover="Tags">Tags</span></a></li>
        
        <li><a href="/archives/"><span data-hover="Archives">Archives</span></a></li>
        
      </ul>
      
      <span >© <a href="https://gglee.netlify.app">gglee</a> 2020 | <a href="https://github.com/gglee4ai">Github</a></span>
      
    </div>
  </div>
</footer>

<script async>
(function() {
  function center_el(tagName) {
    var tags = document.getElementsByTagName(tagName), i, tag;
    for (i = 0; i < tags.length; i++) {
      tag = tags[i];
      var parent = tag.parentElement;
      
      if (parent.childNodes.length === 1) {
        
        if (parent.nodeName === 'A') {
          parent = parent.parentElement;
          if (parent.childNodes.length != 1) continue;
          parent.firstChild.style.border = 'none';
        }
        if (parent.nodeName === 'P') parent.style.textAlign = 'center';
      }
    }
  }
  var tagNames = ['img', 'embed', 'object'];
  for (var i = 0; i < tagNames.length; i++) {
    center_el(tagNames[i]);
  }
})();
</script>


<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
        text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
        code.textContent = text;
      }
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$(.|\s)+\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  
        continue;
      }
    }
    i++;
  }
})();
</script>

<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>






<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
<script>
hljs.configure({languages: []});
hljs.initHighlightingOnLoad();
</script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-162930875-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


</body>
</html>
